---
layout:     post
title:      REST_IN_PRACTICE-软件版本号定义
subtitle:   软件版本号定义/语义化版本控制规范2.0.0/GNU/Windows/.NET Framework
date:       2020-09-08
author:     Claire
header-img: img/post-bg-universe.jpg
catalog: true
tags:
    - 软件版本号定义
    - 语义化版本控制规范2.0.0
    - GNU/Windows/.NET Framework
---

# 如何设置软件版本号

## 一、版本迭代的意义

- 方便团队沟通
- 问题方便追踪和回溯
- 能够实现测试版本到生产版本的平稳过度

## 二、语义化版本控制规范2.0.0

- [语义化版本 2.0.0](https://semver.org/lang/zh-CN/#spec-item-6)
- 版本控制的原因：避免依赖地域，版本混乱无法维护
- 以下摘取部分内容，便于查看

```txt
版本格式：主版本号.次版本号.修订号，版本号递增规则如下：

主版本号：当你做了不兼容的 API 修改，
次版本号：当你做了向下兼容的功能性新增，
修订号：当你做了向下兼容的问题修正。
先行版本号及版本编译元数据可以加到“主版本号.次版本号.修订号”的后面，作为延伸。
```

### 语义规范

```text

1.使用语义化版本控制的软件必须（MUST）定义公共 API。该 API 可以在代码中被定义或出现于严谨的文件内。无论何种形式都应该力求精确且完整。

2.标准的版本号必须（MUST）采用 X.Y.Z 的格式，其中 X、Y 和 Z 为非负的整数，且禁止（MUST NOT）在数字前方补零。X 是主版本号、Y 是次版本号、而 Z 为修订号。每个元素必须（MUST）以数值来递增。例如：1.9.1 -> 1.10.0 -> 1.11.0。

3.标记版本号的软件发行后，禁止（MUST NOT）改变该版本软件的内容。任何修改都必须（MUST）以新版本发行。

4.主版本号为零（0.y.z）的软件处于开发初始阶段，一切都可能随时被改变。这样的公共 API 不应该被视为稳定版。

5.1.0.0 的版本号用于界定公共 API 的形成。这一版本之后所有的版本号更新都基于公共 API 及其修改内容。

***6.修订号 Z（x.y.Z | x > 0）必须（MUST）在只做了向下兼容的修正时才递增。这里的修正指的是针对不正确结果而进行的内部修改。

***7.次版本号 Y（x.Y.z | x > 0）必须（MUST）在有向下兼容的新功能出现时递增。在任何公共 API 的功能被标记为弃用时也必须（MUST）递增。也可以（MAY）在内部程序有大量新功能或改进被加入时递增，其中可以（MAY）包括修订级别的改变。每当次版本号递增时，修订号必须（MUST）归零。

***8.主版本号 X（X.y.z | X > 0）必须（MUST）在有任何不兼容的修改被加入公共 API 时递增。其中可以（MAY）包括次版本号及修订级别的改变。每当主版本号递增时，次版本号和修订号必须（MUST）归零。

9.先行版本号可以（MAY）被标注在修订版之后，先加上一个连接号再加上一连串以句点分隔的标识符来修饰。标识符必须（MUST）由 ASCII 字母数字和连接号 [0-9A-Za-z-] 组成，且禁止（MUST NOT）留白。数字型的标识符禁止（MUST NOT）在前方补零。先行版的优先级低于相关联的标准版本。被标上先行版本号则表示这个版本并非稳定而且可能无法满足预期的兼容性需求。范例：1.0.0-alpha、1.0.0-alpha.1、1.0.0-0.3.7、1.0.0-x.7.z.92。

10.版本编译元数据可以（MAY）被标注在修订版或先行版本号之后，先加上一个加号再加上一连串以句点分隔的标识符来修饰。标识符必须（MUST）由 ASCII 字母数字和连接号 [0-9A-Za-z-] 组成，且禁止（MUST NOT）留白。当判断版本的优先层级时，版本编译元数据可（SHOULD）被忽略。因此当两个版本只有在版本编译元数据有差别时，属于相同的优先层级。范例：1.0.0-alpha+001、1.0.0+20130313144700、1.0.0-beta+exp.sha.5114f85。

11.版本的优先层级指的是不同版本在排序时如何比较。判断优先层级时，必须（MUST）把版本依序拆分为主版本号、次版本号、修订号及先行版本号后进行比较（版本编译元数据不在这份比较的列表中）。由左到右依序比较每个标识符，第一个差异值用来决定优先层级：主版本号、次版本号及修订号以数值比较，例如：1.0.0 < 2.0.0 < 2.1.0 < 2.1.1。当主版本号、次版本号及修订号都相同时，改以优先层级比较低的先行版本号决定。例如：1.0.0-alpha < 1.0.0。有相同主版本号、次版本号及修订号的两个先行版本号，其优先层级必须（MUST）透过由左到右的每个被句点分隔的标识符来比较，直到找到一个差异值后决定：只有数字的标识符以数值高低比较，有字母或连接号时则逐字以 ASCII 的排序来比较。数字的标识符比非数字的标识符优先层级低。若开头的标识符都相同时，栏位比较多的先行版本号优先层级比较高。范例：1.0.0-alpha < 1.0.0-alpha.1 < 1.0.0-alpha.beta < 1.0.0-beta < 1.0.0-beta.2 < 1.0.0-beta.11 < 1.0.0-rc.1 < 1.0.0。
```

### Q & A

1.针对0.y.z阶段如何进行版本控制？

  以 0.1.0 作为你的初始化开发版本，并在后续的每次发行时递增次版本号

2.如何判断何时应该发布1.0.0版本？

   (1)当你的软件被用于正式环境，它应该已经达到了 1.0.0 版。

   (2)如果你已经有个稳定的 API 被使用者依赖，也会是 1.0.0 版。

   (3)如果你很担心向下兼容的问题，也应该算是 1.0.0 版了

3.对于公共 API，若即使是最小但不向下兼容的改变都需要产生新的主版本号，岂不是很快就达到 42.0.0 版？

   这边作者认为发布不向下兼容的API就需要付出一定代价，意味着你必须为这些改变所带来的影响深思熟虑，并且评估所涉及的成本及效益比

4.如果我更新了自己的依赖但没有改变公共 API 该怎么办？

   由于没有影响到公共 API，这可以被认定是兼容的。但是具体迭代修订号或是次版本号，需要具体问题具体分析

5.我该如何处理即将弃用的功能？

   （1）更新你的文件让使用者知道这个改变，

   （2）在适当的时机将弃用的功能透过新的次版本号发布。在新的主版本完全移除弃用功能前，至少要有一个次版本包含这个弃用信息

## 三、命名风格

### 三种命名风格

- 基于二中提到的语义规范，衍生出了三种命名风格：GNU 风格的版本号命名格式、Windows 风格的版本号命名格式、.Net Framework 风格的版本号命名格式
- GNU 风格的版本号命名格式: **主版本号 . 子版本号 [. 修正版本号 [. 编译版本号 ]]**
- Windows 风格的版本号命名格式:  **主版本号 . 子版本号 [. 修正版本号 [. 编译版本号 ]]**
- .Net Framework 风格的版本号命名格式: **主版本号.子版本号[.编译版本号[.修正版本号]]**
- 主版本号Major: 具有相同名称但不同主版本号的程序集不可互换。例如，这适用于对产品的大量重写，这些重写使得无法实现向后兼容性
- 次版本号Minor: 如果两个程序集的名称和主版本号相同，而次版本号不同，具备向后兼容的新功能增加
- 内部版本号Build: 内部版本号的不同表示对相同源所作的重新编译
- 修订号Revision: 适用于修复以前发布的程序集中的安全漏洞

## 四、版本号如何定义

- 可采用以上三种风格中一种进行实践，此处选择GNU风格，目前团队中也正在使用此种方法进行版本号的迭代
- 主版本号.次版本号.修订版本号.日期版本号.希腊字母版本号

```text
1. 主版本号修改 当功能模块有较大的变动，比如增加多个模块或者整体架构发生变化。此版本号由项目决定是否修改。

2. 子版本号修改 当功能有一定的增加或变化，比如增加了对权限控制、增加自定义视图等功能。此版本号由项目决定是否修改。

3. 阶段版本号修改 一般是 Bug 修复或是一些小的变动，要经常发布修订版，时间间隔不限，修复一个严重的bug即可发布一个修订版。此版本号由项目经理决定是否修改。

4. 日期版本号 用于记录修改项目的当前日期，每天对项目的修改都需要更改日期版本号。此版本号由开发人员决定是否修改。

5. 希腊字母版本号 此版本号用于标注当前版本的软件处于哪个开发阶段，当软件进入到另一个阶段时需要修改此版本号。此版本号由项目决定是否修改。
```

- 希腊字母阶段说明

```text
Base版: 此版本表示该软件仅仅是一个假页面链接，通常包括所有的功能和页面布局，但是页面中的功能都没有做完整的实现，只是做为整体网站的一个基础架构。

Alpha版: 此版本表示该软件在此阶段主要是以实现软件功能为主，通常只在软件开发者内部交流，一般而言，该版本软件的Bug较多，需要继续修改。

Beta版: 该版本相对于α版已有了很大的改进，消除了严重的错误，但还是存在着一些缺陷，需要经过多次测试来进一步消除，此版本主要的修改对像是软件的UI。

RC版: 该版本已经相当成熟了，基本上不存在导致错误的BUG，与即将发行的正式版相差无几。

Release版: 该版本意味“最终版本”，在前面版本的一系列测试版之后，终归会有一个正式版本，是最终交付用户使用的一个版本。该版本有时也称为标准版。一般情况下，Release不会以单词形式出现在软件封面上，取而代之的是符号(Ｒ)。
```